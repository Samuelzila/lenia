static final float iMarginX = 1100;
static final float iMarginX2 = 1400;
static final float iMarginY = 74;
static final float iBoxSize = 20;
static final float iPannelSize = 30;
static final float iTextFontSize = 28;
static final float iBoxPaddingR = 8;
static final float iBoxColorSubH = 18;
static final float iBoxColorW = 720;
static final float iBoxColorL = 40;
static final float iBoxColorR = 40;
static final float iBoxColorCenter = 40;

float iPauseBoxX = iMarginX;
float iPauseBoxY = iMarginY + (iPannelSize - iBoxSize)/2;
float iPauseBoxW = iBoxSize;
float iPauseBoxH = iBoxSize;
float iPauseTextX = iMarginX + iBoxSize + iBoxPaddingR;
float iPauseTextY = iMarginY;
float iPauseTextW;
float iPauseTextH = iPannelSize;
float iRecordBoxX = iMarginX;
float iRecordBoxY = iMarginY + (iPannelSize - iBoxSize)/2 + 1*iPannelSize;
float iRecordBoxW = iBoxSize;
float iRecordBoxH = iBoxSize;
float iRecordTextX = iMarginX + iBoxSize + iBoxPaddingR;
float iRecordTextY = iMarginY + 1*iPannelSize;
float iRecordTextW;
float iRecordTextH = iPannelSize;
float iLoadBoxX = iMarginX;
float iLoadBoxY = iMarginY + (iPannelSize - iBoxSize)/2 + 2*iPannelSize;
float iLoadBoxW = iBoxSize;
float iLoadBoxH = iBoxSize;
float iLoadTextX = iMarginX + iBoxSize + iBoxPaddingR;
float iLoadTextY = iMarginY + 2*iPannelSize;
float iLoadTextW;
float iLoadTextH = iPannelSize;
float iEffaceBoxX = iMarginX;
float iEffaceBoxY = iMarginY + (iPannelSize - iBoxSize)/2 + 3*iPannelSize;
float iEffaceBoxW = iBoxSize;
float iEffaceBoxH = iBoxSize;
float iEffaceTextX = iMarginX + iBoxSize + iBoxPaddingR;
float iEffaceTextY = iMarginY + 3*iPannelSize;
float iEffaceTextW;
float iEffaceTextH = iPannelSize;
float iAleaBoxX = iMarginX;
float iAleaBoxY = iMarginY + (iPannelSize - iBoxSize)/2 + 4*iPannelSize;
float iAleaBoxW = iBoxSize;
float iAleaBoxH = iBoxSize;
float iAleaTextX = iMarginX + iBoxSize + iBoxPaddingR;
float iAleaTextY = iMarginY + 4*iPannelSize;
float iAleaTextW;
float iAleaTextH = iPannelSize;
float iCarreBoxX = iMarginX;
float iCarreBoxY = iMarginY + (iPannelSize - iBoxSize)/2 + 5*iPannelSize;
float iCarreBoxW = iBoxSize;
float iCarreBoxH = iBoxSize;
float iCarreTextX = iMarginX + iBoxSize + iBoxPaddingR;
float iCarreTextY = iMarginY + 5*iPannelSize;
float iCarreTextW;
float iCarreTextH = iPannelSize;
float iRayonpincTextX = iMarginX;
float iRayonpincTextY = iMarginY + 6*iPannelSize;
float iRayonpincTextW;
float iRayonpincTextH = iPannelSize;
float iRayonpincChevronGauX;
float iRayonpincChevronGauY = iMarginY + 6*iPannelSize;
float iRayonpincChevronGauW = iBoxSize;
float iRayonpincChevronGauH = iPannelSize;
float iRayonpincValeurX;
float iRayonpincValeurY = iMarginY + 6*iPannelSize;
float iRayonpincValeurW;
float iRayonpincValeurH = iPannelSize;
float iRayonpincChevronDroX;
float iRayonpincChevronDroY = iMarginY + 6*iPannelSize;
float iRayonpincChevronDroW = iBoxSize;
float iRayonpincChevronDroH = iPannelSize;
float iIntenpincTextX = iMarginX;
float iIntenpincTextY = iMarginY + 7*iPannelSize;
float iIntenpincTextW;
float iIntenpincTextH = iPannelSize;
float iIntenpincChevronGauX;
float iIntenpincChevronGauY = iMarginY + 7*iPannelSize;
float iIntenpincChevronGauW = iBoxSize;
float iIntenpincChevronGauH = iPannelSize;
float iIntenpincValeurX;
float iIntenpincValeurY = iMarginY + 7*iPannelSize;
float iIntenpincValeurW;
float iIntenpincValeurH = iPannelSize;
float iIntenpincChevronDroX;
float iIntenpincChevronDroY = iMarginY + 7*iPannelSize;
float iIntenpincChevronDroW = iBoxSize;
float iIntenpincChevronDroH = iPannelSize;
float iCanalBoxX = iMarginX2;
float iCanalBoxY = iMarginY + (iPannelSize - iBoxSize)/2;
float iCanalBoxW = iBoxSize;
float iCanalBoxH = iBoxSize;
float iCanalTextX = iMarginX2 + iBoxSize + iBoxPaddingR;
float iCanalTextY = iMarginY;
float iCanalTextW;
float iCanalTextH = iPannelSize;
float iCanalChevronGauX;
float iCanalChevronGauY = iMarginY;
float iCanalChevronGauW = iBoxSize;
float iCanalChevronGauH = iPannelSize;
float iCanalValeurX;
float iCanalValeurY = iMarginY;
float iCanalValeurW;
float iCanalValeurH = iPannelSize;
float iCanalChevronDroX;
float iCanalChevronDroY = iMarginY;
float iCanalChevronDroW = iBoxSize;
float iCanalChevronDroH = iPannelSize;
float iBoxColorX = iMarginX + iBoxColorL;
float iBoxColorY = iMarginY + 9*iPannelSize;
float iBoxColorH = iPannelSize;
float iBoxColorHue1X = iMarginX + iBoxColorL;
float iBoxColorHue1Y = iMarginY + 11*iPannelSize - iBoxColorSubH;
float iBoxColorHue1W = (iBoxColorW - iBoxColorCenter) / 2;
float iBoxColorHue1H = iBoxColorSubH;
float iBoxColorHue2X = iMarginX + iBoxColorL + iBoxColorHue1W + iBoxColorCenter;
float iBoxColorHue2Y = iMarginY + 11*iPannelSize - iBoxColorSubH;
float iBoxColorHue2W = (iBoxColorW - iBoxColorCenter) / 2;
float iBoxColorHue2H = iBoxColorSubH;
float iBoxColorHueOriX = iMarginX + iBoxColorL + iBoxColorHue1W;
float iBoxColorHueOriY = iMarginY + 11*iPannelSize - iBoxColorSubH;
float iBoxColorHueOriW = iBoxColorCenter;
float iBoxColorHueOriH = iBoxColorSubH;
float iBoxColorSat1X = iMarginX + iBoxColorL;
float iBoxColorSat1Y = iMarginY + 12*iPannelSize - iBoxColorSubH;
float iBoxColorSat1W = (iBoxColorW - iBoxColorCenter) / 2;
float iBoxColorSat1H = iBoxColorSubH;
float iBoxColorSat2X = iMarginX + iBoxColorL + iBoxColorHue1W + iBoxColorCenter;
float iBoxColorSat2Y = iMarginY + 12*iPannelSize - iBoxColorSubH;
float iBoxColorSat2W = (iBoxColorW - iBoxColorCenter) / 2;
float iBoxColorSat2H = iBoxColorSubH;
float iBoxColorLight1X = iMarginX + iBoxColorL;
float iBoxColorLight1Y = iMarginY + 13*iPannelSize - iBoxColorSubH;
float iBoxColorLight1W = (iBoxColorW - iBoxColorCenter) / 2;
float iBoxColorLight1H = iBoxColorSubH;
float iBoxColorLight2X = iMarginX + iBoxColorL + iBoxColorHue1W + iBoxColorCenter;
float iBoxColorLight2Y = iMarginY + 13*iPannelSize - iBoxColorSubH;
float iBoxColorLight2W = (iBoxColorW - iBoxColorCenter) / 2;
float iBoxColorLight2H = iBoxColorSubH;

void interfaceSetup() {
  noFill();
  stroke(255);
  strokeWeight(1);
  textSize(48);
  text("Simulation", 10, 46);
  line(0, 54, 0, 1079);
  line(0, 54, 1025, 54);
  line(0, 1079, 1025, 1079);
  line(1025, 54, 1025, 1079);
  text("Parameters", 1090, 46);
  rect(1079, 54, 840, 484);
  text("Statistics", 1090, 586);
  rect(1079, 594, 840, 484);

  textSize(iTextFontSize);
  iPauseTextW = textWidth("Pause")+1;
  iRecordTextW = textWidth("Record")+1;
  iLoadTextW = textWidth("Load state")+1;
  iEffaceTextW = textWidth("Efface")+1;
  iAleaTextW = textWidth("Aléatoire")+1;
  iCarreTextW = textWidth("Carré")+1;
  iRayonpincTextW = textWidth("Rayon pinceau :")+1;
  iIntenpincTextW = textWidth("Intensité pinceau :")+1;
  iCanalTextW = textWidth("Canal :")+1;

  iRayonpincChevronGauX = iMarginX + iRayonpincTextW + iBoxPaddingR;
  iRayonpincValeurX = iRayonpincChevronGauX + iBoxSize;
  iRayonpincValeurW = textWidth("00")+1;
  iRayonpincChevronDroX = iRayonpincValeurX + iRayonpincValeurW;
  iIntenpincChevronGauX = iMarginX + iIntenpincTextW + iBoxPaddingR;
  iIntenpincValeurX = iIntenpincChevronGauX + iBoxSize;
  iIntenpincValeurW = textWidth("0,00")+1;
  iIntenpincChevronDroX = iIntenpincValeurX + iIntenpincValeurW;

  iCanalChevronGauX = iMarginX2 + iBoxSize + iBoxPaddingR + iCanalTextW + iBoxPaddingR;
  iCanalValeurX = iCanalChevronGauX + iBoxSize;
  iCanalValeurW = textWidth("0")+1;
  iCanalChevronDroX = iCanalValeurX + iCanalValeurW;
}

void interfaceDraw() {
  // PARAMÈTRES
  fill(0);
  noStroke();
  rect(1080, 55, 838, 482);  // Tout effacer à chaque nouvel affichage (rectangle noir)

  stroke(255);
  strokeWeight(2);

  if (playing) {
    fill(0);
  } else {
    fill(192);
  }
  rect(iPauseBoxX, iPauseBoxY, iPauseBoxW, iPauseBoxH);

  // Record
  fill(recording ? 192 : 0);
  rect(iRecordBoxX, iRecordBoxY, iRecordBoxW, iRecordBoxH);

  // Load state
  fill(0);
  rect(iLoadBoxX, iLoadBoxY, iLoadBoxW, iLoadBoxH);

  // Efface
  if (efface) {
    fill(192);
  } else {
    fill(0);
  }
  rect(iEffaceBoxX, iEffaceBoxY, iEffaceBoxW, iEffaceBoxH);

  //Aléatoire
  if (aleatoire) {
    fill(192);
  } else {
    fill(0);
  }
  rect(iAleaBoxX, iAleaBoxY, iAleaBoxW, iAleaBoxH);

  //Carré
  if (carre) {
    fill(192);
  } else {
    fill(0);
  }
  rect(iCarreBoxX, iCarreBoxY, iCarreBoxW, iCarreBoxH);

  //Canaux
  if (NB_CHANNELS >= 2) {
    if (canaux) {
      fill(192);
    } else {
      fill(0);
    }
    rect(iCanalBoxX, iCanalBoxY, iCanalBoxW, iCanalBoxH);
  }

  // Palette de couleurs
  colorMode(HSB, 360, 100, 100);
  for (int x = 0; x < iBoxColorW; x++) {
    color colorLine = getColorPalette(x/iBoxColorW, canal);
    stroke(colorLine);
    line(iBoxColorX + x, iBoxColorY, iBoxColorX + x, iBoxColorY + iBoxColorH);
  }
  stroke(360);
  line(iBoxColorX, iBoxColorY, iBoxColorX, iBoxColorY + iBoxColorH);
  line(iBoxColorX, iBoxColorY, iBoxColorX + iBoxColorW, iBoxColorY);
  line(iBoxColorX + iBoxColorW, iBoxColorY, iBoxColorX + iBoxColorW, iBoxColorY + iBoxColorH);
  line(iBoxColorX, iBoxColorY + iBoxColorH, iBoxColorX + iBoxColorW, iBoxColorY + iBoxColorH);

  // Hue
  for (int x = 0; x < iBoxColorHue1W; x++) {
    color colorLine = color(int(360 * x/iBoxColorHue1W), 100, 100);
    stroke(colorLine);
    line(iBoxColorHue1X + x, iBoxColorHue1Y, iBoxColorHue1X + x, iBoxColorHue1Y + iBoxColorHue1H);
  }
  for (int x = 0; x < iBoxColorHue1W; x++) {
    color colorLine = color(int(360 * x/iBoxColorHue1W), 100, 100);
    stroke(colorLine);
    line(iBoxColorHue2X + x, iBoxColorHue2Y, iBoxColorHue2X + x, iBoxColorHue2Y + iBoxColorHue2H);
    //line(iMarginX+x+40+380, iMarginY + 10*iPannelSize + iBoxColorPaddingB, iMarginX+x+40+380, iMarginY + 11*iPannelSize);
  }
  if (NB_CHANNELS==1) {
    // Saturation
    for (int x = 0; x < iBoxColorSat1W; x++) {
      color colorLine = color(0, int(100 * x/iBoxColorSat1W), 100);
      stroke(colorLine);
      line(iBoxColorSat1X + x, iBoxColorSat1Y, iBoxColorSat1X + x, iBoxColorSat1Y + iBoxColorHue1H);
    }
    for (int x = 0; x < iBoxColorSat2W; x++) {
      color colorLine = color(0, int(100 * x/iBoxColorSat2W), 100);
      stroke(colorLine);
      line(iBoxColorSat2X + x, iBoxColorSat2Y, iBoxColorSat2X + x, iBoxColorSat2Y + iBoxColorHue2H);
    }
    // Lightness
    for (int x = 0; x < iBoxColorLight1W; x++) {
      color colorLine = color(0, 100, int(100 * x/iBoxColorLight1W));
      stroke(colorLine);
      line(iBoxColorLight1X + x, iBoxColorLight1Y, iBoxColorLight1X + x, iBoxColorLight1Y + iBoxColorLight1H);
    }
    for (int x = 0; x < iBoxColorSat2W; x++) {
      color colorLine = color(0, 100, int(100 * x/iBoxColorLight2W));
      stroke(colorLine);
      line(iBoxColorLight2X + x, iBoxColorLight2Y, iBoxColorLight2X + x, iBoxColorLight2Y + iBoxColorLight2H);
    }
  }

  // Rectangles encadrant les palettes de couleurs
  stroke(360);
  line(iBoxColorX, iBoxColorY, iBoxColorX, iBoxColorY + iBoxColorH);
  line(iBoxColorX, iBoxColorY, iBoxColorX + iBoxColorW, iBoxColorY);
  line(iBoxColorX + iBoxColorW, iBoxColorY, iBoxColorX + iBoxColorW, iBoxColorY + iBoxColorH);
  line(iBoxColorX, iBoxColorY + iBoxColorH, iBoxColorX + iBoxColorW, iBoxColorY + iBoxColorH);
  line(iBoxColorHue1X, iBoxColorHue1Y, iBoxColorHue1X, iBoxColorHue1Y + iBoxColorHue1H);
  line(iBoxColorHue1X, iBoxColorHue1Y, iBoxColorHue1X + iBoxColorHue1W, iBoxColorHue1Y);
  line(iBoxColorHue1X + iBoxColorHue1W, iBoxColorHue1Y, iBoxColorHue1X + iBoxColorHue1W, iBoxColorHue1Y + iBoxColorHue1H);
  line(iBoxColorHue1X, iBoxColorHue1Y + iBoxColorHue1H, iBoxColorHue1X + iBoxColorHue1W, iBoxColorHue1Y + iBoxColorHue1H);
  line(iBoxColorHue2X, iBoxColorHue2Y, iBoxColorHue2X, iBoxColorHue2Y + iBoxColorHue2H);
  line(iBoxColorHue2X, iBoxColorHue2Y, iBoxColorHue2X + iBoxColorHue2W, iBoxColorHue2Y);
  line(iBoxColorHue2X + iBoxColorHue2W, iBoxColorHue2Y, iBoxColorHue2X + iBoxColorHue2W, iBoxColorHue2Y + iBoxColorHue2H);
  line(iBoxColorHue2X, iBoxColorHue2Y + iBoxColorHue2H, iBoxColorHue2X + iBoxColorHue2W, iBoxColorHue2Y + iBoxColorHue2H);
  if (NB_CHANNELS==1) {
    line(iBoxColorSat1X, iBoxColorSat1Y, iBoxColorSat1X, iBoxColorSat1Y + iBoxColorSat1H);
    line(iBoxColorSat1X, iBoxColorSat1Y, iBoxColorSat1X + iBoxColorSat1W, iBoxColorSat1Y);
    line(iBoxColorSat1X + iBoxColorSat1W, iBoxColorSat1Y, iBoxColorSat1X + iBoxColorSat1W, iBoxColorSat1Y + iBoxColorSat1H);
    line(iBoxColorSat1X, iBoxColorSat1Y + iBoxColorSat1H, iBoxColorSat1X + iBoxColorSat1W, iBoxColorSat1Y + iBoxColorSat1H);
    line(iBoxColorSat2X, iBoxColorSat2Y, iBoxColorSat2X, iBoxColorSat2Y + iBoxColorSat2H);
    line(iBoxColorSat2X, iBoxColorSat2Y, iBoxColorSat2X + iBoxColorSat2W, iBoxColorSat2Y);
    line(iBoxColorSat2X + iBoxColorSat2W, iBoxColorSat2Y, iBoxColorSat2X + iBoxColorSat2W, iBoxColorSat2Y + iBoxColorSat2H);
    line(iBoxColorSat2X, iBoxColorSat2Y + iBoxColorSat2H, iBoxColorSat2X + iBoxColorSat2W, iBoxColorSat2Y + iBoxColorSat2H);
    line(iBoxColorLight1X, iBoxColorLight1Y, iBoxColorLight1X, iBoxColorLight1Y + iBoxColorLight1H);
    line(iBoxColorLight1X, iBoxColorLight1Y, iBoxColorLight1X + iBoxColorLight1W, iBoxColorLight1Y);
    line(iBoxColorLight1X + iBoxColorLight1W, iBoxColorLight1Y, iBoxColorLight1X + iBoxColorLight1W, iBoxColorLight1Y + iBoxColorLight1H);
    line(iBoxColorLight1X, iBoxColorLight1Y + iBoxColorLight1H, iBoxColorLight1X + iBoxColorLight1W, iBoxColorLight1Y + iBoxColorLight1H);
    line(iBoxColorLight2X, iBoxColorLight2Y, iBoxColorLight2X, iBoxColorLight2Y + iBoxColorLight2H);
    line(iBoxColorLight2X, iBoxColorLight2Y, iBoxColorLight2X + iBoxColorLight2W, iBoxColorLight2Y);
    line(iBoxColorLight2X + iBoxColorLight2W, iBoxColorLight2Y, iBoxColorLight2X + iBoxColorLight2W, iBoxColorLight2Y + iBoxColorLight2H);
    line(iBoxColorLight2X, iBoxColorLight2Y + iBoxColorLight2H, iBoxColorLight2X + iBoxColorLight2W, iBoxColorLight2Y + iBoxColorLight2H);
  }

  // Indication choix couleur
  fill(0);
  stroke(330);
  rect(iBoxColorHue1X + iBoxColorHue1W*colpalHue1[canal]/360., iBoxColorHue1Y - 2, 5, iBoxColorHue1H + 4);
  rect(iBoxColorHue2X + iBoxColorHue2W*colpalHue2[canal]/360., iBoxColorHue2Y - 2, 5, iBoxColorHue2H + 4);
  if (NB_CHANNELS==1) {
    rect(iBoxColorSat1X + iBoxColorSat1W*colpalSat1[canal]/100., iBoxColorSat1Y - 2, 5, iBoxColorSat1H + 4);
    rect(iBoxColorSat2X + iBoxColorSat2W*colpalSat2[canal]/100., iBoxColorSat2Y - 2, 5, iBoxColorSat2H + 4);
    rect(iBoxColorLight1X + iBoxColorLight1W*colpalLight1[canal]/100., iBoxColorLight1Y - 2, 5, iBoxColorLight1H + 4);
    rect(iBoxColorLight2X + iBoxColorLight2W*colpalLight2[canal]/100., iBoxColorLight2Y - 2, 5, iBoxColorLight2H + 4);
  }


  if (NB_CHANNELS >= 2) {
    if (showChannel0) {
      fill(192);
    } else {
      fill(0);
    }
    rect(1400, 120, 20, 20);
    if (showChannel1) {
      fill(192);
    } else {
      fill(0);
    }
    rect(1400, 150, 20, 20);
  }
  if (NB_CHANNELS >= 3) {
    if (showChannel2) {
      fill(192);
    } else {
      fill(0);
    }
    rect(1400, 180, 20, 20);
  }
  //Étampes
  if (stamps) {
    fill(192);
  } else {
    fill(0);
  }
  rect(1700, 90, 20, 20);


  //Text
  textSize(iTextFontSize);
  fill(330);
  textAlign(LEFT, CENTER);
  text("Pause", iPauseTextX, iPauseTextY, iPauseTextW, iPauseTextH);
  text("Record", iRecordTextX, iRecordTextY, iRecordTextW, iRecordTextH);
  text("Load state", iLoadTextX, iLoadTextY, iLoadTextW, iLoadTextH);
  text("Efface", iEffaceTextX, iEffaceTextY, iEffaceTextW, iEffaceTextH);
  text("Aléatoire", iAleaTextX, iAleaTextY, iAleaTextW, iAleaTextH);
  text("Carré", iCarreTextX, iCarreTextY, iCarreTextW, iCarreTextH);

  text("Rayon pinceau :", iRayonpincTextX, iRayonpincTextY, iRayonpincTextW, iRayonpincTextH);
  textAlign(CENTER, CENTER);
  text("<", iRayonpincChevronGauX, iRayonpincChevronGauY, iRayonpincChevronGauW, iRayonpincChevronGauH);
  text(str(rayonPinceau), iRayonpincValeurX, iRayonpincValeurY, iRayonpincValeurW, iRayonpincValeurH);
  text(">", iRayonpincChevronDroX, iRayonpincChevronDroY, iRayonpincChevronDroW, iRayonpincChevronDroH);

  textAlign(LEFT, CENTER);
  text("Intensité pinceau :", iIntenpincTextX, iIntenpincTextY, iIntenpincTextW, iIntenpincTextH);
  textAlign(CENTER, CENTER);
  text("<", iIntenpincChevronGauX, iIntenpincChevronGauY, iIntenpincChevronGauW, iIntenpincChevronGauH);
  text(String.format("%.2f", intensitePinceau), iIntenpincValeurX, iIntenpincValeurY, iIntenpincValeurW, iIntenpincValeurH);
  text(">", iIntenpincChevronDroX, iIntenpincChevronDroY, iIntenpincChevronDroW, iIntenpincChevronDroH);

  // Couleur
  textAlign(CENTER, CENTER);
  text("0", iMarginX, iMarginY + 9*iPannelSize, textWidth("0")+1, iPannelSize);
  text("1", iMarginX+780, iMarginY + 9*iPannelSize, textWidth("1")+1, iPannelSize);

  // Orientation de la teinte (hue)
  textAlign(CENTER, CENTER);
  String textOrientation = "";
  if (colpalHueOri[0]==1) {
    textOrientation = "→";
  } else {
    textOrientation = "←";
  }
  text(textOrientation, iMarginX+40+340, iMarginY + 10*iPannelSize + 4, 40, iPannelSize);

  // Canal
  if (NB_CHANNELS >= 2) {
    textAlign(LEFT, CENTER);
    text("Canal :", iCanalTextX, iCanalTextY, iCanalTextW, iCanalTextH);
    textAlign(CENTER, CENTER);
    text("<", iCanalChevronGauX, iCanalChevronGauY, iCanalChevronGauW, iCanalChevronGauH);
    text(str(canal+1), iCanalValeurX, iCanalValeurY, iCanalValeurW, iCanalValeurH);
    text(">", iCanalChevronDroX, iCanalChevronDroY, iCanalChevronDroW, iCanalChevronDroH);
  }

  textAlign(LEFT);
  if (NB_CHANNELS >= 2) {
    text("1", 1440, 140);

    text("2", 1440, 170);
  }
  if (NB_CHANNELS >= 3) {
    text("3", 1440, 200);
  }

  text("Étampes", 1735, 110);
  text("Angle : < " + String.format("%03d", angle) + " >", 1700, 140);
  textAlign(CENTER, CENTER);

  // STATISTICS
}

void interactionParameters() {
  // Activer/désactiver le bouton « Pause »
  if (mouseButton == LEFT && (mouseX >= iPauseBoxX) && (mouseX <= iPauseBoxX+iPauseBoxW) && (mouseY >= iPauseBoxY) && (mouseY <= iPauseBoxY+iPauseBoxH)) {
    playing = !playing;
  }
  // Activer/désactiver le bouton « Recording » pour enregistrer les états.
  if (mouseButton == LEFT && (mouseX >= iRecordBoxX) && (mouseX <= iRecordBoxX+iRecordBoxW) && (mouseY >= iRecordBoxY) && (mouseY <= iRecordBoxY+iRecordBoxH)) {
    recording = !recording;
  }
  // Activer/désactiver le bouton « Load State » pour charger les états.
  if (mouseButton == LEFT && (mouseX >= iLoadBoxX) && (mouseX <= iLoadBoxX+iLoadBoxW) && (mouseY >= iLoadBoxY) && (mouseY <= iLoadBoxY+iLoadBoxH)) {
    playing = false;
    recording = false;
    selectInput("", "loadState");
  }
  // Activer/désactiver le bouton « Efface »
  if (mouseButton == LEFT && (mouseX >= iEffaceBoxX) && (mouseX <= iEffaceBoxX+iEffaceBoxW) && (mouseY >= iEffaceBoxY) && (mouseY <= iEffaceBoxY+iEffaceBoxH)) {
    efface = !efface;
  }
  // Activer/désactiver le bouton « Aléatoire »
  if (mouseButton == LEFT && (mouseX >= iAleaBoxX) && (mouseX <= iAleaBoxX+iAleaBoxW) && (mouseY >= iAleaBoxY) && (mouseY <= iAleaBoxY+iAleaBoxH)) {
    aleatoire = !aleatoire;
  }
  // Activer/désactiver le bouton « Carré »
  if (mouseButton == LEFT && (mouseX >= iCarreBoxX) && (mouseX <= iCarreBoxX+iCarreBoxW) && (mouseY >= iCarreBoxY) && (mouseY <= iCarreBoxY+iCarreBoxH)) {
    carre = !carre;
  }
  // Modifier le rayon
  if (mouseButton == LEFT && (mouseX >= iRayonpincChevronGauX) && (mouseX <= iRayonpincChevronGauX + iRayonpincChevronGauW) && (mouseY >= iRayonpincChevronGauY) && (mouseY <= iRayonpincChevronGauY + iRayonpincChevronGauH) && intensitePinceau > 0.1) {
    rayonPinceau = rayonPinceau - 1;
  }
  if (mouseButton == LEFT && (mouseX >= iRayonpincChevronDroX) && (mouseX <= iRayonpincChevronDroX + iRayonpincChevronDroW) && (mouseY >= iRayonpincChevronDroY) && (mouseY <= iRayonpincChevronDroY + iRayonpincChevronDroH) && intensitePinceau < 99) {
    rayonPinceau = rayonPinceau + 1;
  }
  // Modifier l'intensité du pinceau
  if (mouseButton == LEFT && (mouseX >= iIntenpincChevronGauX) && (mouseX <= iIntenpincChevronGauX + iIntenpincChevronGauW) && (mouseY >= iIntenpincChevronGauY) && (mouseY <= iIntenpincChevronGauY + iIntenpincChevronGauH) && intensitePinceau > 0.1) {
    intensitePinceau = intensitePinceau - 0.05;
  }
  if (mouseButton == LEFT && (mouseX >= iIntenpincChevronDroX) && (mouseX <= iIntenpincChevronDroX + iIntenpincChevronDroW) && (mouseY >= iIntenpincChevronDroY) && (mouseY <= iIntenpincChevronDroY + iIntenpincChevronDroH) && intensitePinceau < 99) {
    intensitePinceau = intensitePinceau + 0.05;
  }
  // Activer/désactiver le bouton « Canal »
  if (mouseButton == LEFT && (mouseX >= iCanalBoxX) && (mouseX <= iCanalBoxX+iCanalBoxW) && (mouseY >= iCanalBoxY) && (mouseY <= iCanalBoxY+iCanalBoxH)) {
    canaux = !canaux;
  }
  // Modifier le canal
  if (mouseButton == LEFT && (mouseX >= iCanalChevronGauX) && (mouseX <= iCanalChevronGauX + iCanalChevronGauW) && (mouseY >= iCanalChevronGauY) && (mouseY <= iCanalChevronGauY + iCanalChevronGauH) && canal > 0) {
    canal = canal - 1;
  }
  if (mouseButton == LEFT && (mouseX >= iCanalChevronDroX) && (mouseX <= iCanalChevronDroX + iCanalChevronDroW) && (mouseY >= iCanalChevronDroY) && (mouseY <= iCanalChevronDroY + iCanalChevronDroH) && canal < NB_CHANNELS-1) {
    canal = canal + 1;
  }
  // Modifier la palette de couleurs
  if (mouseButton==LEFT && mouseX>=iBoxColorHue1X && mouseX<=iBoxColorHue1X+iBoxColorHue1W && mouseY>=iBoxColorHue1Y && mouseY<=iBoxColorHue1Y+iBoxColorHue1H) {
    colpalHue1[canal] = 360 * (mouseX - iBoxColorHue1X)/iBoxColorHue1W;
  }
  if (mouseButton==LEFT && mouseX>=iBoxColorHue2X && mouseX<=iBoxColorHue2X+iBoxColorHue2W && mouseY>=iBoxColorHue2Y && mouseY<=iBoxColorHue2Y+iBoxColorHue2H) {
    colpalHue2[canal] = 360 * (mouseX - iBoxColorHue2X)/iBoxColorHue2W;
  }
  if (mouseButton==LEFT && mouseX>=iBoxColorHueOriX && mouseX<=iBoxColorHueOriX+iBoxColorHueOriW && mouseY>=iBoxColorHueOriY && mouseY<=iBoxColorHueOriY+iBoxColorHueOriH) {
    colpalHueOri[canal] = (colpalHueOri[canal] + 1) % 2;
  }
  if (NB_CHANNELS==1 && mouseButton==LEFT && mouseX>=iBoxColorSat1X && mouseX<=iBoxColorSat1X+iBoxColorSat1W && mouseY>=iBoxColorSat1Y && mouseY<=iBoxColorSat1Y+iBoxColorSat1H) {
    colpalSat1[canal] = 100 * (mouseX - iBoxColorSat1X)/iBoxColorSat1W;
  }
  if (NB_CHANNELS==1 && mouseButton==LEFT && mouseX>=iBoxColorSat2X && mouseX<=iBoxColorSat2X+iBoxColorSat2W && mouseY>=iBoxColorSat2Y && mouseY<=iBoxColorSat2Y+iBoxColorSat2H) {
    colpalSat2[canal] = 100 * (mouseX - iBoxColorSat2X)/iBoxColorSat2W;
  }
  if (NB_CHANNELS==1 && mouseButton==LEFT && mouseX>=iBoxColorLight1X && mouseX<=iBoxColorLight1X+iBoxColorLight1W && mouseY>=iBoxColorLight1Y && mouseY<=iBoxColorLight1Y+iBoxColorLight1H) {
    colpalLight1[canal] = 100 * (mouseX - iBoxColorLight1X)/iBoxColorLight1W;
  }
  if (NB_CHANNELS==1 && mouseButton==LEFT && mouseX>=iBoxColorLight2X && mouseX<=iBoxColorLight2X+iBoxColorLight2W && mouseY>=iBoxColorLight2Y && mouseY<=iBoxColorLight2Y+iBoxColorLight2H) {
    colpalLight2[canal] = 100 * (mouseX - iBoxColorLight2X)/iBoxColorLight2W;
  }


  if (stamps && mouseButton == LEFT && (mouseX < 1026)) {
    int orbium_scaling_factor = 0;// Facteur de mise à l'échelle de l'orbium.
    if (WORLD_DIMENSIONS == 1024) {
      orbium_scaling_factor = 8;
    } else if (WORLD_DIMENSIONS == 512) {
      orbium_scaling_factor = 16;
    }
    rotateMatrix(angle, orbium);
    for (int x = 0; x < orbium.length; x++)
      for (int y = 0; y < orbium[0].length; y++)
        for (int i = x*orbium_scaling_factor*zoom; i < (x+1)*orbium_scaling_factor*zoom; i++)
          for (int j = y*orbium_scaling_factor*zoom; j < (y+1)*orbium_scaling_factor*zoom; j++)
            world[canal][Math.floorMod(((((mouseX + j)/(1024/WORLD_DIMENSIONS))-(deplacementX*zoom)) / (zoom)), WORLD_DIMENSIONS)* WORLD_DIMENSIONS + Math.floorMod((((mouseY-56+i)/(1024/WORLD_DIMENSIONS)-(deplacementY*zoom)) / (zoom)), WORLD_DIMENSIONS)] = orbium[x][y];
  }

  if (mouseButton == LEFT && (mouseX >= 1700) && (mouseX <= 1720) && (mouseY >= 90) && (mouseY <= 110)) {
    stamps = !stamps;
  }
  if (mouseButton == LEFT && (mouseX >= 1790) && (mouseX <= 1810) && (mouseY >= 120) && (mouseY <= 140)) {
    angle = Math.floorMod(angle - 30, 360);
  }
  if (mouseButton == LEFT && (mouseX >= 1860) && (mouseX <= 1880) && (mouseY >= 120) && (mouseY <= 140)) {
    angle = Math.floorMod(angle + 30, 360);
  }
  if (mouseButton == LEFT && (mouseX >= 1400) && (mouseX <= 1420) && (mouseY >= 120) && (mouseY <= 140)) {
    showChannel0 = !showChannel0;
  }
  if (mouseButton == LEFT && (mouseX >= 1400) && (mouseX <= 1420) && (mouseY >= 150) && (mouseY <= 170)) {
    showChannel1 = !showChannel1;
  }
  if (mouseButton == LEFT && (mouseX >= 1400) && (mouseX <= 1420) && (mouseY >= 180) && (mouseY <= 200)) {
    showChannel2 = !showChannel2;
  }
  //Pour changer les canaux dans l'affichage des statistiques
  if (mouseButton == LEFT && (mouseX >= coordonneeXStat + 163) && (mouseX <= coordonneeXStat + 185) &&(mouseY <= initialYStat) && (mouseY >= initialYStat -20)  && selectedChanelStat > 0) {
    selectedChanelStat--;
  }
  if (mouseButton == LEFT && (mouseX >= coordonneeXStat + 220) && (mouseX <= coordonneeXStat + 250) &&(mouseY <= initialYStat) && (mouseY >= initialYStat -20)  && selectedChanelStat < world.length) {
    selectedChanelStat++;
  }

  //Pour afficher le centre de masse et le centre de croissance
  if (mouseButton == LEFT && mouseX >= 1100 && mouseX <= 1120 && mouseY >= ecartStat*10 + initialYStat - 20 && mouseY <=  ecartStat*10 + initialYStat) {
    showCentroid =! showCentroid;
  }
  if (mouseButton == LEFT && mouseX >= 1100 && mouseX <= 1120 && mouseY >= ecartStat*11 + initialYStat - 20 && mouseY <=  ecartStat*11 + initialYStat) {
    showGrowthCenter =! showGrowthCenter;
  }
  //Changement du noyau sélectionné
  if (mouseButton == LEFT && mouseX >= 1565 && mouseX <= 1605 && mouseY >= 165 && mouseY <= 187 && !playing && selectedKernel > 0) {
    selectedKernel --;
  }
  if (mouseButton == LEFT && mouseX >= 1610&& mouseX <= 1650 && mouseY >= 165 && mouseY <=187 && !playing && selectedKernel < kernels.length-1) {
    selectedKernel ++;
  }

  //Changement du rayon du noyau
  if (mouseButton == LEFT && mouseX >= 1535 && mouseX <= 1590 && mouseY >= 190 && mouseY <= 207 && !playing && kernels[selectedKernel].getR() > 6 ) {
    decreaseRadius(selectedKernel);
  }
  if (mouseButton == LEFT && mouseX >= 1595 && mouseX <= 1740 && mouseY >= 190 && mouseY <= 207 && !playing) {
    increaseRadius(selectedKernel);
  }

  //Changement de mu
  if (mouseButton == LEFT && mouseX >= 1535 && mouseX <= 1575 && mouseY >= 210 && mouseY <= 227 && !playing && kernels[selectedKernel].getMu() >= 0.02) {
    decreaseMu(selectedKernel);
  }
  if (mouseButton == LEFT && mouseX >= 1585 && mouseX <= 1625 && mouseY >= 210 && mouseY <= 227 && !playing) {
    increaseMu(selectedKernel);
  }

  //Changement de sigma
  if (mouseButton == LEFT && mouseX >= 1545 && mouseX <= 1595 && mouseY >= 230 && mouseY <= 247 && !playing && kernels[selectedKernel].getSigma() >= 0.002) {
    decreaseSigma(selectedKernel);
  }

  if (mouseButton == LEFT && mouseX >= 1615 && mouseX <= 1655 && mouseY >= 230 && mouseY <= 247 && !playing) {
    increaseSigma(selectedKernel);
  }

  //Changement du canal d'entrée
  // rect(1695, 170, 40, 17);
  if (mouseButton == LEFT && mouseX >= 1745 && mouseX <= 1785 && mouseY >= 190 && mouseY <= 207 && !playing && kernels[selectedKernel].getinputchanel() > 0) {
    decreaseInput(selectedKernel);
  }
  if (mouseButton == LEFT && mouseX >= 1790 && mouseX <= 1830 && mouseY >= 190 && mouseY <= 207 && !playing && kernels[selectedKernel].getinputchanel() < kernels.length - 1) {
    increaseInput(selectedKernel);
  }

  //Changement du canal de sortie
  if (mouseButton == LEFT && mouseX >= 1740 && mouseX <= 1780 && mouseY >= 210 && mouseY <= 227 && !playing && kernels[selectedKernel].getOutputchanel() > 0) {
    decreaseOutput(selectedKernel);
  }
  if (mouseButton == LEFT && mouseX >= 1785 && mouseX <= 1825 && mouseY >= 210 && mouseY <= 227 && !playing && kernels[selectedKernel].getOutputchanel() < kernels.length - 1) {
    increaseOutput(selectedKernel);
  }

  //Changement du poids du noyau
  if (mouseButton == LEFT && mouseX >= 1740 && mouseX <= 1780 && mouseY >= 230 && mouseY <= 247 && !playing && kernels[selectedKernel].getWeight() > 0) {
    decreaseWeigth(selectedKernel);
  }
  if (mouseButton == LEFT && mouseX >= 1785 && mouseX <= 1825 && mouseY >= 230 && mouseY <= 247 && !playing) {
    increaseWeigth(selectedKernel);
  }

  //Changement de la fonction core
  if (mouseButton == LEFT && mouseX >= 1745 && mouseX <= 1795 && mouseY >= 250 && mouseY <= 267 && !playing) {
    changeCoreFunction(selectedKernel);
  }

  //Changement de la growth function
  if (mouseButton == LEFT && mouseX >= 1785 && mouseX <= 1835 && mouseY >= 270 && mouseY <= 287 && !playing) {
    changeGrowthFunction(selectedKernel);
  }
  
  //Changement de FFT
  if (mouseButton == LEFT && mouseX >= 1755 && mouseX <= 1773 && mouseY >= 169 && mouseY <= 187 && !playing) {
    kernels[selectedKernel].useFft = !kernels[selectedKernel].useFft;
  }

  //Application des changements
  //rect(1455, 270, 260, 23);
  if (mouseButton == LEFT && mouseX >= 1505 && mouseX <= 1765 && mouseY >= 290 && mouseY <= 313 && !playing) {
    kernels[selectedKernel].refresh();
  }
}
